
## 演示功能概述

使用Air8000核心板，通过gnss.lua扩展库，开启GNSS定位，展示模块的三种功耗模式：正常模式，低功耗模式，PSM+模式 

## 演示硬件环境

1、Air8000核心板一块

2、TYPE-C USB数据线一根

3、gnss天线一根

4、Air8000核心板和数据线的硬件接线方式为

- Air8000核心板通过TYPE-C USB口供电；（核心板USB旁边的开关拨到on一端）

- TYPE-C USB数据线直接插到核心板的TYPE-C USB座子，另外一端连接电脑USB口；


## 演示软件环境

1、Luatools下载调试工具

2、[Air8000 V2010版本固件](https://docs.openluat.com/air8000/luatos/firmware/)

## 演示核心步骤

1、搭建好硬件环境

2、通过Luatools将demo与固件烧录到核心板中

3、烧录好后，板子开机将会在Luatools上看到如下打印：

(1) 开机连接到服务器：

```lua
[2025-07-27 15:51:28.235][000000003.099] D/mobile NETIF_LINK_ON -> IP_READY
[2025-07-27 15:51:28.287][000000003.100] D/socket connect to 112.125.89.8,45259
[2025-07-27 15:51:28.338][000000003.100] network_socket_connect 1573:network 0 local port auto select 50641
[2025-07-27 15:51:28.369][000000003.137] D/mobile TIME_SYNC 0
[2025-07-27 15:51:28.419][000000003.151] network_default_socket_callback 1103:before process socket 0,event:0xf2000009(连接成功),state:3(正在连接),wait:2(等待连接完成)
[2025-07-27 15:51:28.471][000000003.152] network_default_socket_callback 1107:after process socket 0,state:5(在线),wait:0(无等待)
[2025-07-27 15:51:28.523][000000003.192] network_default_socket_callback 1103:before process socket 0,event:0xf2000004(发送成功),state:5(在线),wait:3(等待发送完成)
[2025-07-27 15:51:28.564][000000003.192] network_default_socket_callback 1107:after process socket 0,state:5(在线),wait:0(无等待)
[2025-07-27 15:51:28.615][000000003.194] I/user.3214816 114708 116960
[2025-07-27 15:51:43.110][000000018.196] I/user.3214816 108516 116960
[2025-07-27 15:51:58.123][000000033.198] I/user.3214816 108552 116960
[2025-07-27 15:52:13.118][000000048.199] I/user.3214816 108632 116960

```

(2) 开启GNSS定位成功后发送数据到服务器：

```lua
[2025-07-27 15:52:25.226][000000060.305] I/user.gnss.open 2 MODE1 60 function: 0C7F0448
[2025-07-27 15:52:25.260][000000060.306] Uart_ChangeBR 1338:uart2, 115200 115203 26000000 3611
[2025-07-27 15:52:25.293][000000060.307] I/user.全卫星开启
[2025-07-27 15:52:25.335][000000060.307] I/user.agps开启
[2025-07-27 15:52:25.370][000000060.308] D/sntp query ntp.aliyun.com
[2025-07-27 15:52:25.383][000000060.308] dns_run 674:ntp.aliyun.com state 0 id 1 ipv6 0 use dns server2, try 0
[2025-07-27 15:52:25.392][000000060.313] I/user.gnss._open
[2025-07-27 15:52:25.402][000000060.478] dns_run 691:dns all done ,now stop
[2025-07-27 15:52:25.452][000000060.541] D/sntp Unix timestamp: 1753602745
[2025-07-27 15:52:25.476][000000060.545] I/user.gnss.opts 开始执行AGPS
[2025-07-27 15:52:25.505][000000060.549] I/user.os.time 1753602745
[2025-07-27 15:52:25.526][000000060.549] I/user.agps_time 1753602626
[2025-07-27 15:52:25.551][000000060.553] I/user.gnss.opts 星历不需要更新 119
[2025-07-27 15:52:25.563][000000060.570] D/user.lbsLoc2 free.bs.air32.cn 12411
[2025-07-27 15:52:25.583][000000060.571] D/socket connect to free.bs.air32.cn,12411
[2025-07-27 15:52:25.596][000000060.571] dns_run 674:free.bs.air32.cn state 0 id 2 ipv6 0 use dns server2, try 0
[2025-07-27 15:52:25.624][000000060.598] dns_run 691:dns all done ,now stop
[2025-07-27 15:52:25.661][000000060.737] D/user.lbsLoc2 rx 0030540816031183837001
[2025-07-27 15:52:25.681][000000060.740] I/user.lbsLoc2 34.580613000000 113.83807100000
[2025-07-27 15:52:25.706][000000060.745] I/user.gnss.opts 写入星历数据 长度 5294
[2025-07-27 15:52:25.743][000000060.746] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:25.764][000000060.846] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:25.859][000000060.947] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:25.971][000000061.048] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.071][000000061.149] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.166][000000061.250] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.225][000000061.313] I/user.gnss.timerFnc@1 2 MODE1 60 60 nil
[2025-07-27 15:52:26.267][000000061.351] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.364][000000061.452] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.465][000000061.553] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.576][000000061.654] I/user.gnss AGNSS write >>> 512
[2025-07-27 15:52:26.676][000000061.755] I/user.gnss AGNSS write >>> 174
[2025-07-27 15:52:26.783][000000061.857] I/user.gnss.opts 写入GPS坐标 3434.8367800000 11350.284260000
[2025-07-27 15:52:26.836][000000061.857] I/user.gnss.opts 参考时间 $AIDTIME,2025,7,27,7,52,26,000
[2025-07-27 15:52:26.852][000000061.878] I/user.gnss.opts 写入AGPS参考位置 $AIDPOS,3434.8367800,N,11350.2842600,E,1.0

[2025-07-27 15:52:27.233][000000062.314] I/user.gnss.timerFnc@1 2 MODE1 60 59 nil
[2025-07-27 15:52:28.111][000000063.201] I/user.3214816 121176 121936
[2025-07-27 15:52:28.228][000000063.315] I/user.gnss.timerFnc@1 2 MODE1 60 58 nil
[2025-07-27 15:52:29.237][000000064.316] I/user.gnss.timerFnc@1 2 MODE1 60 57 nil
[2025-07-27 15:52:30.236][000000065.317] I/user.gnss.timerFnc@1 2 MODE1 60 56 nil
[2025-07-27 15:52:30.417][000000065.496] I/gnss Fixed 343481049 1135041395
[2025-07-27 15:52:30.487][000000065.575] I/user.gnss.statInd@1 true 2 MODE1 60 55 nil function: 0C7F0448
[2025-07-27 15:52:31.232][000000066.318] I/user.gnss.timerFnc@1 2 MODE1 60 55 1
[2025-07-27 15:52:31.276][000000066.319] I/user.TAGmode1_cb+++++++++ MODE1
[2025-07-27 15:52:31.319][000000066.320] I/user.nmea rmc {"variation":0,"lat":3434.8105469,"min":52,"valid":true,"day":27,"lng":11350.4140625,"speed":0.2220000,"year":2025,"month":7,"sec":30,"hour":7,"course":302.4410095}
[2025-07-27 15:52:31.336][000000066.321] I/user.gnss.close 2 MODE1 60 function: 0C7F0448
[2025-07-27 15:52:31.352][000000066.328] I/user.gnss._close
[2025-07-27 15:52:31.373][000000066.330] I/user.发送到服务器数据，长度 38
[2025-07-27 15:52:31.394][000000066.456] network_default_socket_callback 1103:before process socket 0,event:0xf2000004(发送成功),state:5(在线),wait:3(等待发送完成)
[2025-07-27 15:52:31.412][000000066.456] network_default_socket_callback 1107:after process socket 0,state:5(在线),wait:0(无等待)
[2025-07-27 15:52:31.427][000000066.457] I/user.3214816 119380 122432
[2025-07-27 15:52:46.373][000000081.459] I/user.3214816 113240 122432
```